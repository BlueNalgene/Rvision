<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">



<title>2 - Input/output operations</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">2 - Input/output operations</h1>



<p><strong>This page describes how to read and write videos and images with <a href="https://github.com/swarm-lab/Rvision"><code>Rvision</code></a>.</strong></p>
<hr />
<ul>
<li><a href="#reading">2.1 - Reading</a>
<ul>
<li><a href="#videos">2.1.1 - Videos</a></li>
<li><a href="#camera-streams">2.1.2 - Camera streams</a></li>
<li><a href="#images">2.1.3 - Images</a>
<ul>
<li><a href="#from-files">2.1.3.1 - From files</a></li>
<li><a href="#from-videos">2.1.3.2 - From videos</a></li>
<li><a href="#from-camera-streams">2.1.3.3 - From streams</a></li>
</ul></li>
</ul></li>
<li><a href="#writing">2.2 - Writing</a>
<ul>
<li><a href="#videos-1">2.2.1 - Videos</a></li>
<li><a href="#images-1">2.2.2 - Images</a></li>
</ul></li>
</ul>
<hr />
<div id="reading" class="section level2">
<h2>2.1 - Reading</h2>
<div id="videos" class="section level3">
<h3>2.1.1 - Videos</h3>
<p>You can create a <code>Video</code> object from a video file as follows:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">path_to_video &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;sample_vid&quot;</span>, <span class="st">&quot;Balloon.mp4&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;Rvision&quot;</span>)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">my_video &lt;-<span class="st"> </span><span class="kw">video</span>(<span class="dt">filename =</span> path_to_video)</a></code></pre></div>
<p><code>Video</code> objects can be released from memory as follows:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">release</span>(my_video)</a></code></pre></div>
<p>Note that <code>Video</code> objects are wrappers around <a href="http://opencv.org/"><code>OpenCV</code></a> <a href="https://docs.opencv.org/3.4.1/d8/dfe/classcv_1_1VideoCapture.html"><code>VideoCapture</code></a> objects. They will not persist between <a href="https://cran.r-project.org"><code>R</code></a> sessions.</p>
</div>
<div id="camera-streams" class="section level3">
<h3>2.1.2 - Camera streams</h3>
<p>You can create a <code>Stream</code> object from a camera stream as follows:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">my_stream &lt;-<span class="st"> </span><span class="kw">stream</span>(<span class="dt">index =</span> <span class="dv">0</span>)</a></code></pre></div>
<p>The index argument takes an integer number corresponding to the position of the camera in the list of video capturing devices available on your computer. 0 corresponds to the default camera, which is usually the embedded webcam on most computers. Note that the order of the list of video capturing devices might change after each computer restart.</p>
<p><code>Stream</code> objects can be released from memory as follows:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">release</span>(my_stream)</a></code></pre></div>
<p>Note that <code>Stream</code> objects are wrappers around <a href="http://opencv.org/"><code>OpenCV</code></a> <a href="https://docs.opencv.org/3.4.1/d8/dfe/classcv_1_1VideoCapture.html"><code>VideoCapture</code></a> objects. They will not persist between <a href="https://cran.r-project.org"><code>R</code></a> sessions.</p>
</div>
<div id="images" class="section level3">
<h3>2.1.3 - Images</h3>
<p>There are three ways to create <code>Image</code> objects: from files, from <code>Video</code> objects, and from <code>Stream</code> objects.</p>
<p>Note that <code>Image</code> objects are wrappers around <a href="http://opencv.org/"><code>OpenCV</code></a> <a href="https://docs.opencv.org/3.4.1/d3/d63/classcv_1_1Mat.html"><code>Mat</code></a> objects. They will not persist between <a href="https://cran.r-project.org"><code>R</code></a> sessions.</p>
<div id="from-files" class="section level4">
<h4>2.1.3.1 - From files</h4>
<p>You can create an <code>Image</code> object from an image file as follows:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">path_to_image &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;sample_img&quot;</span>, <span class="st">&quot;bunny.png&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;Rvision&quot;</span>)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">my_image &lt;-<span class="st"> </span><span class="kw">image</span>(<span class="dt">filename =</span> path_to_image)</a></code></pre></div>
</div>
<div id="from-videos" class="section level4">
<h4>2.1.3.2 - From videos</h4>
<p>You can create an <code>Image</code> object from the next available frame of a <code>Video</code> object as follows:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">my_image &lt;-<span class="st"> </span><span class="kw">readNext</span>(my_video)</a></code></pre></div>
<p>You can create an <code>Image</code> object from any arbitrary frame of a <code>Video</code> object as follows (here frame number 100):</p>
</div>
<div id="from-camera-streams" class="section level4">
<h4>2.1.3.3 - From camera streams</h4>
<p>You can create an <code>Image</code> object from the next available frame of a <code>Stream</code> object as follows:</p>
<hr />
</div>
</div>
</div>
<div id="writing" class="section level2">
<h2>2.2 - Writing</h2>
<div id="videos-1" class="section level3">
<h3>2.2.1 - Videos</h3>
<p>Videos can be written to the disk using a <code>VideoWriter</code> object.</p>
<p>When creating a <code>VideoWriter</code> object, you need to specify the codec of the video, its framerate, its height and its width. For instance, we will here create a <code>VideoWriter</code> object that will save to a temporary <a href="https://en.wikipedia.org/wiki/MPEG-4_Part_14"><code>mp4</code></a> video file using the <a href="https://www.videolan.org/developers/x264.html"><code>x264</code></a> codec at 30fps.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">path_to_video &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">tempfile</span>(), <span class="st">&quot;.mp4&quot;</span>)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">my_writer &lt;-<span class="st"> </span><span class="kw">videoWriter</span>(path_to_video, <span class="dt">fourcc =</span> <span class="st">&quot;x264&quot;</span>, <span class="dt">fps =</span> <span class="dv">30</span>, <span class="dt">height =</span> <span class="dv">720</span>, <span class="dt">width =</span> <span class="dv">1280</span>)</a></code></pre></div>
<p>Once a <code>VideoWriter</code> object has been created, you can write individual frames to it. For instance, we will here capture 30 frames from the default webcam and write them to the video file.</p>
<p><code>VideoWriter</code> objects can be released from memory as follows:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw">release</span>(my_writer)</a></code></pre></div>
<p>Note that <code>VideoWriter</code> objects are wrappers around <a href="http://opencv.org/"><code>OpenCV</code></a> <a href="https://docs.opencv.org/3.4.1/dd/d9e/classcv_1_1VideoWriter.html"><code>VideoWriter</code></a> objects. They will not persist between <a href="https://cran.r-project.org"><code>R</code></a> sessions.</p>
</div>
<div id="images-1" class="section level3">
<h3>2.2.2 - Images</h3>
<p>Writing an image to a file is straightforward using the <code>write.Image</code> function.</p>
<p><a href="https://github.com/swarm-lab/Rvision"><code>Rvision</code></a> will guess the format of the image file from the file extension. For instance, we will here capture 1 frame from the default webcam and write it to a temporary png image file.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
